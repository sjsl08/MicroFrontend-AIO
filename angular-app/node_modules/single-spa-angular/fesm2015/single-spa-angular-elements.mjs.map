{"version":3,"file":"single-spa-angular-elements.mjs","sources":["../../libs/single-spa-angular/elements/src/index.ts","../../libs/single-spa-angular/elements/src/single-spa-angular-elements.ts"],"sourcesContent":["import { LifeCycles } from 'single-spa';\nimport { NgElement } from '@angular/elements';\nimport {\n  BaseSingleSpaAngularOptions,\n  getContainerElementAndSetTemplate,\n} from 'single-spa-angular/internals';\n\nimport { BootstrappedSingleSpaAngularElementsOptions } from './types';\n\nconst defaultOptions: BootstrappedSingleSpaAngularElementsOptions = {\n  element: null,\n  template: null!,\n  ngModuleRefOrAppRef: null,\n  bootstrapFunction: null!,\n  domElementGetter: undefined,\n};\n\nasync function bootstrap(options: BootstrappedSingleSpaAngularElementsOptions, props: any) {\n  if (options.ngModuleRefOrAppRef !== null) {\n    return;\n  }\n\n  // We call `bootstrapFunction()` inside the bootstrap lifecycle hook\n  // because Angular modules that expose custom elements should be\n  // bootstrapped only once.\n  options.ngModuleRefOrAppRef = await options.bootstrapFunction(props);\n}\n\nasync function mount(options: BootstrappedSingleSpaAngularElementsOptions, props: any) {\n  const containerElement = getContainerElementAndSetTemplate(options, props);\n  // `options.template` which can be `<app-element />` is not a valid selector\n  // for `document.querySelector`, thus we retrieve this custom element\n  // via this property.\n  options.element = containerElement.firstElementChild as NgElement;\n}\n\nfunction unmount(options: BootstrappedSingleSpaAngularElementsOptions): Promise<void> {\n  return Promise.resolve().then(() => {\n    // Removing custom element from DOM is enough since it will trigger\n    // `disconnectedCallback()` and Angular will dispose all resources.\n    options.element!.parentElement!.removeChild(options.element!);\n    options.element = null;\n  });\n}\n\nexport function singleSpaAngularElements(userOptions: BaseSingleSpaAngularOptions): LifeCycles {\n  const options: BootstrappedSingleSpaAngularElementsOptions = {\n    ...defaultOptions,\n    ...userOptions,\n  };\n\n  return {\n    bootstrap: bootstrap.bind(null, options),\n    mount: mount.bind(null, options),\n    unmount: unmount.bind(null, options),\n  };\n}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":[],"mappings":";;;AASA,MAAM,cAAc,GAAgD;AAClE,IAAA,OAAO,EAAE,IAAI;AACb,IAAA,QAAQ,EAAE,IAAK;AACf,IAAA,mBAAmB,EAAE,IAAI;AACzB,IAAA,iBAAiB,EAAE,IAAK;AACxB,IAAA,gBAAgB,EAAE,SAAS;CAC5B,CAAC;AAEF,SAAe,SAAS,CAAC,OAAoD,EAAE,KAAU,EAAA;;AACvF,QAAA,IAAI,OAAO,CAAC,mBAAmB,KAAK,IAAI,EAAE;YACxC,OAAO;AACR,SAAA;;;;QAKD,OAAO,CAAC,mBAAmB,GAAG,MAAM,OAAO,CAAC,iBAAiB,CAAC,KAAK,CAAC,CAAC;KACtE,CAAA,CAAA;AAAA,CAAA;AAED,SAAe,KAAK,CAAC,OAAoD,EAAE,KAAU,EAAA;;QACnF,MAAM,gBAAgB,GAAG,iCAAiC,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC;;;;AAI3E,QAAA,OAAO,CAAC,OAAO,GAAG,gBAAgB,CAAC,iBAA8B,CAAC;KACnE,CAAA,CAAA;AAAA,CAAA;AAED,SAAS,OAAO,CAAC,OAAoD,EAAA;IACnE,OAAO,OAAO,CAAC,OAAO,EAAE,CAAC,IAAI,CAAC,MAAK;;;QAGjC,OAAO,CAAC,OAAQ,CAAC,aAAc,CAAC,WAAW,CAAC,OAAO,CAAC,OAAQ,CAAC,CAAC;AAC9D,QAAA,OAAO,CAAC,OAAO,GAAG,IAAI,CAAC;AACzB,KAAC,CAAC,CAAC;AACL,CAAC;AAEK,SAAU,wBAAwB,CAAC,WAAwC,EAAA;AAC/E,IAAA,MAAM,OAAO,GACR,MAAA,CAAA,MAAA,CAAA,MAAA,CAAA,MAAA,CAAA,EAAA,EAAA,cAAc,CACd,EAAA,WAAW,CACf,CAAC;IAEF,OAAO;QACL,SAAS,EAAE,SAAS,CAAC,IAAI,CAAC,IAAI,EAAE,OAAO,CAAC;QACxC,KAAK,EAAE,KAAK,CAAC,IAAI,CAAC,IAAI,EAAE,OAAO,CAAC;QAChC,OAAO,EAAE,OAAO,CAAC,IAAI,CAAC,IAAI,EAAE,OAAO,CAAC;KACrC,CAAC;AACJ;;ACxDA;;AAEG;;;;"}